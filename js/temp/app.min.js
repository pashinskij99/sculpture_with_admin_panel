var Apps=function(){function G(){l=window.innerWidth/2;e.aspect=window.innerWidth/window.innerHeight;e.updateProjectionMatrix();a.setSize(window.innerWidth,window.innerHeight)}function p(a,g){f&&k.remove(f);f=new THREE.Group;k.add(f);for(var c=[],b=[],d=0;3>=d;d++)b.push(0);for(var e=0,e=a?Math.round(46*Math.random()+4):B,d=0;d<e;d++){var h=new THREE.Vector4(400*Math.random()-200,400*Math.random(),400*Math.random()-200,1);c.push(h);b.push(THREE.Math.clamp((d+1)/(e-3),0,1))}nurbsCurve=new THREE.NURBSCurve(3,
b,c);q=q&&g?q:nurbsCurve.getPoints(200);d=new THREE.SplineCurve3(q);THREE.ImageUtils.loadTexture("img/plastic.jpg").wrapT=THREE.RepeatWrapping;c=w?w:C;b=g?g:3;e=new THREE.TubeGeometry(d,500,b,8);nurbsLine=new THREE.Mesh(e,c);nurbsLine.category="changes";d=d.points;c=new THREE.Mesh(new THREE.SphereGeometry(b,10,10),c);c.position.x=d[0].x;c.position.y=d[0].y-100;c.position.z=d[0].z;c.category="changes";b=c.clone();b.position.x=d[d.length-1].x;b.position.y=d[d.length-1].y-100;b.position.z=d[d.length-
1].z;f.add(c);f.add(b);nurbsLine.position.set(0,-100,0);nurbsLine.castShadow=!0;c=new THREE.Geometry;c.vertices=nurbsCurve.controlPoints;b=new THREE.LineBasicMaterial({linewidth:2,color:16777215,opacity:.25});(new THREE.Line(c,b)).position.copy(nurbsLine.position);f.add(nurbsLine)}function H(b){b.preventDefault();a.domElement.addEventListener("mousemove",x,!1);a.domElement.addEventListener("mouseup",y,!1);a.domElement.addEventListener("mouseout",z,!1);r=b.clientX-l;t=m}function x(a){u=a.clientX-l;
m=t+.02*(u-r)}function y(b){a.domElement.removeEventListener("mousemove",x,!1);a.domElement.removeEventListener("mouseup",y,!1);a.domElement.removeEventListener("mouseout",z,!1)}function z(b){a.domElement.removeEventListener("mousemove",x,!1);a.domElement.removeEventListener("mouseup",y,!1);a.domElement.removeEventListener("mouseout",z,!1)}function I(a){1==a.touches.length&&(a.preventDefault(),r=a.touches[0].pageX-l,t=m)}function J(a){1==a.touches.length&&(a.preventDefault(),u=a.touches[0].pageX-
l,m=t+.05*(u-r))}function D(){requestAnimationFrame(D);f.rotation.y+=.05*(m-f.rotation.y);e.updateMatrixWorld();a.clear();a.render(k,e);n.update()}var A,n,e,k,a,f,m=0,t=0,u=0,r=0,l=window.innerWidth/2,C=new THREE.MeshPhongMaterial({side:THREE.DoubleSide,shading:THREE.SmoothShading,opacity:1,color:11121587}),w,h,E,v,b=[],B=20,q=!1;THREE.ImageUtils.loadTexture("img/textures/posz.jpg",!1,function(f){h=f;h.wrapS=h.wrapT=THREE.RepeatWrapping;h.format=THREE.RGBFormat;h.repeat.set(.12,.12);E=new THREE.MeshPhongMaterial({color:"#64655C",
shininess:100,emissive:"#443F37",envMap:F,reflectivity:.05,bumpMap:h,bumpScale:13.91,specular:"#8D8E86",side:THREE.DoubleSide});b[0]=new Image;b[0].src="img/FON_1.jpg";b[0].onload=function(){b[1]=new Image;b[1].src="img/FON_2.jpg";b[1].onload=function(){b[2]=new Image;b[2].src="img/FON_3.jpg";b[2].onload=function(){v=b[0];document.getElementById("main").appendChild(v);A=document.getElementById("back");e=new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,1,5E4);e.position.set(810,
100,0);k=new THREE.Scene;e.rotation.x=1.61;e.rotation.y=1.55;e.rotation.z=-1.57;var g=new THREE.AmbientLight(1118481);k.add(g);spotLight=new THREE.SpotLight(16777215);spotLight.position.set(300,1E3,100);spotLight.target.position.set(0,0,0).normalize();spotLight.shadowCameraNear=.91;spotLight.castShadow=!0;spotLight.shadowDarkness=.25;spotLight.intensity=.99;spotLight.shadowCameraVisible=!1;k.add(spotLight);p();g=new THREE.CubeGeometry(5,10,.2);THREE.ShaderLib.basic.fragmentShader=["uniform vec3 diffuse;\nuniform float opacity;",
THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,
THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"\toutgoingLight = diffuseColor.rgb;",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 - shadowColor.x );\n}"].join("\n");var c=new THREE.MeshBasicMaterial,
g=new THREE.Mesh(g,c);g.scale.multiplyScalar(250);g.position.y=-200;g.position.x=-50;g.rotation.x=Math.PI/2;g.receiveShadow=!0;k.add(g);a=new THREE.WebGLRenderer({antialias:!0,alpha:!0});a.autoClear=!1;a.shadowMapType=THREE.PCFSoftShadowMap;a.shadowMapEnabled=!0;a.shadowMapSoft=!0;a.setClearColor(0,0);a.setPixelRatio(window.devicePixelRatio);a.setSize(window.innerWidth,window.innerHeight);a.shadowCameraNear=3;a.shadowCameraFar=e.far;a.shadowCameraFov=50;a.shadowMapBias=.0039;a.shadowMapDarkness=.5;
a.shadowMapWidth=1024;a.shadowMapHeight=1024;A.appendChild(a.domElement);n=new Stats;n.domElement.style.position="absolute";n.domElement.style.top="0px";A.appendChild(n.domElement);a.domElement.addEventListener("mousedown",H,!1);a.domElement.addEventListener("touchstart",I,!1);a.domElement.addEventListener("touchmove",J,!1);window.addEventListener("resize",G,!1);$(".container-loader").fadeOut();D();K.init()}}}});var F=THREE.ImageUtils.loadTextureCube("img/textures/skybox/gray/posx.jpg img/textures/skybox/gray/negx.jpg img/textures/skybox/gray/posy.jpg img/textures/skybox/gray/negy.jpg img/textures/skybox/gray/posz.jpg img/textures/skybox/gray/negz.jpg".split(" "));
F.format=THREE.RGBFormat;var K={gui:"",init:function(){var a={color:11121587,radious:3,countPoints:20,genereateCounts:function(){p(!0)},genereate:function(){p()},changeBack:function(){},changeTexture:function(){}};this.gui=new dat.GUI({width:280});this.gui.add(a,"genereateCounts").name("Random Count Points");this.gui.add(a,"genereate").name("Generate New Curve");this.gui.add(a,"countPoints").min(4).max(50).name("Count of Points").onChange(function(a){B=a});this.gui.add(a,"radious").min(1).max(10).name("Radious").onChange(function(a){p(!1,
a)});this.gui.addColor(a,"color").name("Color").onChange(function(a){for(var b=0;b<f.children.length;b++)f.children[b].material.color=new THREE.Color(a)});this.gui.add(a,"changeBack",["plastic","metal"]).name("Change Texture").onChange(function(a){switch(a){case "metal":a=E;break;default:a=C}a.needsUpdate=!0;w=a;for(var b=0;b<f.children.length;b++)f.children[b].material=a});this.gui.add(a,"changeBack",["museum","mirror-room","hall"]).name("Change Background").onChange(function(a){document.getElementById("main").removeChild(v);
var c;switch(a){case "museum":c=b[0];break;case "mirror-room":c=b[1];break;case "hall":c=b[2]}v=c;document.getElementById("main").appendChild(c)})}}};$(document).ready(function(){new Apps});